---
title: "Specific leaf area in a coastal temperate deciduous forest: species and salinity effects"
author: "Lillie Haddock"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# Load necessary packages
library(car)
library(dplyr)
library(tidyr)
library(readr)
library(knitr)
library(kableExtra)
library(lubridate)
library(ggplot2)
theme_set(theme_bw())
library(ggmap)
library(cowplot)

ggsave <- function(...) suppressMessages(ggplot2::ggsave(...))

# bootstrap options for kable
bo <- c("striped", "hover", "condensed", "responsive", full_width = FALSE)
```

## Motivation

Specific leaf area (SLA, the ratio of leaf area to leaf dry mass) is an important trait for plant physiological, structural, and modeling analyses. SLA is also a useful measurement to upscale plant production, vegetation community composition, and other processes in Earth System Models, providing current-day benchmarks and improving predictions of future vegetation structure and function in terrestrial ecosystems.

We investigate SLA differences between plots of varying elevation and salinity exposure along a tributary of the Chesapeake Bay. The goals of this project are to (i) quantify SLA of eight major tree species, at multiple canopy heights, in temperate deciduous forests at the Smithsonian Environmental Research Center (Maryland, USA); and (ii) test for effects of soil moisture and saltwater exposure on SLA by comparing samples taken at shoreline and upland positions, with the shoreline samples taken along a ~2 km tidal creek that provided a natural salinity gradient.

Map of SERC with plots labeled:

``` {r serc-map, message=FALSE}
sites <- read.csv(file = "Design/sites.csv")
sites_bbox <- make_bbox(lon = sites$Longitude, lat = sites$Latitude, f = 0.8)
sites_map <- get_map(location = sites_bbox, source = "stamen", maptype = "terrain", zoom = 15)

map <- ggmap(sites_map) +
  geom_point(data = sites, mapping = aes(x = Longitude, y = Latitude), color = "black", size = 1) +
  geom_text(data = sites, 
            aes(x = Longitude, y = Latitude, label = Plot), 
            size = 3, vjust = 2) +
  labs(x = "Longitude", y = "Latitude")
print(map)
ggsave("figures/map.png")
```

## Methods

![Figure 1: Collecting samples using a hand pruner](Photos/sampling1.png) ![Figure 2: All the samples after a morning of collecting](Photos/sampling2.png)

## SLA Data

SLA is the ratio between a leaf's one-sided fresh leaf area and its total dry mass. 

```{r read-sla}
# Read in main data file and compute SLA
read_csv("sla_data.csv", col_types = "ccccdcdddc") %>% 
  mutate(specific_leaf_area = Leaf_Area_cm2 / Leaf_Mass_g) ->
  sla_raw
```

## Inventory Data

```{r read-inventory}
## Read in the TEMPEST inventory data 
# This doesn't include the shore plot at GCREW!
tempest_inventory <- read_csv("inventory/tempest-inventory.csv", col_types = "c-cd-c----")

if(any(duplicated(tempest_inventory$Tag))) {
  warning("We have duplicate tree tags in TEMPEST inventory: ",
          paste(which(duplicated(tempest_inventory$Tag)), collapse = ", "))
}

# Read in transplant inventory data
transplant_inventory <- read_csv("inventory/transplant-inventory.csv", col_types = "-cc-c---d--c") %>% 
  select(Plot, Tag, Species_code, DBH = DBH_cm_2019, Notes)

# Check that no tag numbers are duplicated
if(any(duplicated(transplant_inventory$Tag))) {
  warning("We have duplicate tree tags in transplant inventory: ",
          paste(which(duplicated(transplant_inventory$Tag)), collapse = ", "))
}

# Combine storm surge inventory with transplant inventory
inventory <- bind_rows(transplant_inventory, tempest_inventory) %>% 
  filter(!is.na(Tag))

# Check that no tag numbers are duplicated
# This is DEFENSIVE PROGRAMMING
if(any(duplicated(inventory$Tag))) {
  warning("We have duplicate tree tags in the combined inventory: ",
          paste(which(duplicated(inventory$Tag)), collapse = ", "))
}
```

## Join SLA and inventory data

```{r join-sla-inventory, error = FALSE}
sla_raw %>%
  # Make blank Tag values NAs to stop duplicates when joining
  mutate(Tag = if_else(Tag == "", NA_character_, Tag)) %>% 
  left_join(inventory, by = "Tag") ->
  sla_joined

n_sla_premerge <- nrow(sla_raw)
n_sla_joined <- nrow(sla_joined)

message("Rows in sla_calc: ", n_sla_premerge)
message("Rows in sla_joined: ", n_sla_joined)
if(n_sla_joined != n_sla_premerge) {
  stop("We have a problem!\n")
}

shoreline_plots <- c("Shore", "HSLE", "MSLE", "LSLE")

sla_joined <- sla_joined %>% 
  # if NA DBH, then get information from what we measured in field
  mutate(DBH = if_else(is.na(DBH), No_Tag_DBH, DBH),
         Species_code = if_else(is.na(Species_code), No_Tag_Species_code, Species_code),
         Plot = if_else(is.na(Plot), No_Tag_Plot, Plot)) %>% 
  # We only want four letter species codes, and want to add an elevation column 
  mutate(Species_code = substr(Species_code, 1,4), 
         Elevation = if_else(Plot %in% shoreline_plots, "Shoreline", "Upland")) 
n_sla_joined <- nrow(sla_joined)

# At this point, everything should have a DBH entry
if(any(is.na(sla_joined$DBH))) {
  warning("Missing DBH!\n") 
  paste("Tag:", sla_joined$Tag[which(is.na(sla_joined$DBH))])
}   

# Filter for ACRU, FAGR, LIST, NYSY, QUAL, LITU; others (CA?? and COFL and <= 2)
sla_joined_simple <- sla_joined %>% 
  filter(Species_code %in% c("ACRU", "FAGR", "LIST", "NYSY", "QUAL", "LITU", "CAGL"))

# At this point there should be NO data with an NA for Plot or DBH or Species_code
# Warn if this occurs
if(any(is.na(sla_joined_simple$DBH))) {
  warning("We still have unmatched trees!\n")
  paste("Tag:", sla_joined_simple$Tag[which(is.na(sla_joined_simple$DBH))])
}
if(any(sla_joined_simple$Species_code == "")) {
  warning("We have blank species codes!")  
}

## Join sla_joined_simple with plot species_codes
species_codes <- read_csv("Design/species_codes.csv", col_types = "ccc")
sla <- left_join(sla_joined_simple, species_codes, by = "Species_code")

# QC
n_sla_joined_simple <- nrow(sla_joined_simple)
n_sla <- nrow(sla)
message("Rows in sla_joined_simple: ", n_sla_joined_simple)
message("Rows in sla: ", n_sla)
if(n_sla_joined_simple != n_sla) {
  warning("We have a problem!\n")
}

## Add salinity information 
salinities <- tibble(Plot = shoreline_plots, 
                     Salinity = c("High", "High", "Medium", "Low"))
sla %>% 
  left_join(salinities, by = "Plot") %>% 
  mutate(Salinity = factor(Salinity, levels = c("Low", "Medium", "High"))) ->
  sla
```

### Summary tables

```{r summary-tables}
# Table 1: SLA by species
sla %>% 
  group_by(Species) %>% 
  summarise(n = n(), 
            mean_SLA = mean(specific_leaf_area), 
            sd_SLA = sd(specific_leaf_area)) ->
  sla_by_species

sla_by_species %>% 
  kable(digits = 1, format = "html", 
        col.names = c("Species", "N", "SLA", "s.d."), 
        caption = "Table 1: Specific leaf area by species") %>% 
  kable_styling(bootstrap_options = bo)

# Table 2: SLA by species and plot
sla %>% 
  group_by(Species, Plot) %>% 
  summarise(n = n(), 
            mean_SLA = mean(specific_leaf_area), 
            sd_SLA = sd(specific_leaf_area)) %>% 
  kable(digits = 1, format = "html", 
        col.names = c("Species", "Plot", "N", "SLA", "s.d."), 
        caption = "Table 2: Specific leaf area by plot") %>% 
  kable_styling(bootstrap_options = bo)

# Table 3: SLA by elevation
sla %>% 
  group_by(Elevation) %>% 
  summarise(n = n(), 
            mean_SLA = mean(specific_leaf_area), 
            sd_SLA = sd(specific_leaf_area)) %>% 
  kable(digits = 1, format = "html", 
        col.names = c("Elevation", "N", "SLA", "s.d."),
        caption = "Table 3: Specific leaf area by elevation") %>% 
  kable_styling(bootstrap_options = bo)

# Table 4: SLA canopy position
sla %>%
  group_by(Species, Position) %>% 
  summarise(n = n(),
            mean_SLA = mean(specific_leaf_area),
            sd_SLA = sd(specific_leaf_area)) %>% 
  kable(digits = 1, format = "html", 
        col.names = c("Species", "Canopy position", "N", "SLA", "s.d."), 
        caption = "Table 4: Specific leaf area by canopy position") %>% 
  kable_styling(bootstrap_options = bo)

# Table 5: SLA along salinity gradient
sla %>%
  filter(!is.na(Salinity)) %>% 
  group_by(Species, Salinity) %>% 
  summarise(n = n(), 
            mean_SLA = mean(specific_leaf_area), 
            sd_SLA = sd(specific_leaf_area)) %>% 
  kable(digits = 1, format = "html", 
        col.names = c("Species", "Salinity exposure", "N", "SLA", "s.d."),
        caption = "Table 5: Specific leaf area along salinity gradient") %>% 
  kable_styling(bootstrap_options = bo)

# Table 6: SLA along salinity gradient
sla %>%
  filter(!is.na(Salinity)) %>% 
  group_by(Species, Salinity) %>% 
  summarise(mean_SLA = paste(round(mean(specific_leaf_area), digits = 1), "Â±",
                             round(sd(specific_leaf_area), digits = 1),
                             paste0("(", n(), ")"))) %>% 
  spread(Salinity, mean_SLA, fill = "") %>% 
  kable(digits = 1, format = "html",
        caption = "Table 6: Specific leaf area (cm2/g) along salinity gradient") %>% 
  kable_styling(bootstrap_options = bo)
```


### Quality control plots

```{r qc-plots}
# Species histograms colored by canopy position 
ggplot(sla, aes(x = specific_leaf_area, fill = Position)) + 
  geom_histogram(bins = 30) +
  facet_wrap(~Species)

## Number of leaves sampled vs area
ggplot(sla, aes(n_Leaves, Leaf_Area_cm2, color = Species_code)) +
  geom_point() +
  facet_wrap(~Species_code, scales = "free") +
  geom_smooth(method = "lm") 

## leaves vs mass
ggplot(sla, aes(n_Leaves, Leaf_Mass_g, color = Species_code)) +
  geom_point() +
  facet_wrap(~Species_code, scales = "free") +
  geom_smooth(method = "lm")
```

### Primary figures

``` {r figures, echo=FALSE}
sla %>% 
  #  bind_rows(tibble(Species = "Carya glabra", specific_leaf_area = NA_real_, Position = "High/Sun", Elevation = "Shoreline")) %>% 
  mutate(Species = gsub(" ", "\n", Species)) ->
  sla_figs

# Figure 1: SLA by species and canopy position
fig1 <- ggplot(sla_figs, aes(Species, specific_leaf_area)) +
  geom_boxplot(aes(fill = Position)) +
  labs(x = "Species", y = expression(SLA~(cm^2~g^-1)))
print(fig1)
ggsave("figures/figure1.png")

# Figure 2: SLA by elevation
fig2 <- ggplot(sla_figs, aes(Species, specific_leaf_area)) +
  geom_boxplot(aes(fill = Elevation)) + 
  labs(x = "Species", y = expression(SLA~(cm^2~g^-1)))
print(fig2)
ggsave("figures/figure2.png")

# Figure 3: SLA versus tree size by species
sla %>%
  # Determine which relationships are significant or not
  group_by(Species) %>% 
  do(mod = lm(specific_leaf_area ~ DBH, data = .)) %>% 
  broom::tidy(mod) %>% 
  filter(term == "DBH") %>% 
  ungroup() %>% 
  transmute(Species,
            p.value = round(p.value, 3),
            p_pretty = if_else(p.value < 0.001, "P < 0.001", paste("P =", format(p.value, digits = 3))),
            notsignif = p.value >= 0.05) ->
  mod_signif

sla %>% 
  left_join(mod_signif, by = "Species") %>% 
  ggplot(aes(DBH, specific_leaf_area)) +
  geom_point() + 
  facet_wrap(~Species) +
  geom_smooth(method = "lm", aes(linetype = notsignif), show.legend = FALSE) +
  labs(x = "DBH (cm)", y = expression(SLA~(cm^2~g^-1))) +
  geom_text(data = mod_signif, x = 60, y = 500, aes(label = p_pretty)) ->
  fig3
print(fig3)
ggsave("figures/figure3_sla-vs-dbh.png")
```

## TRY comparison

```{r try-comparison}
# Trait 3116: Leaf area per leaf dry mass (specific leaf area, SLA or 1/LMA): petiole included
# Species: 859, 10831, 23898, 33704, 33707, 38411, 45315
# Downloaded 2020-07-04
trydata_raw <- readLines("try_data/10896.txt")
# There is an invalid string for locale in the download file that screwing things up
# Workaround:
trydata <- suppressWarnings(c(trydata_raw[1], trydata_raw[grep("3116", trydata_raw)]))
textConnection(trydata) %>% 
  read.table(sep = "\t", header = TRUE, stringsAsFactors = FALSE) %>% 
  as_tibble() %>% 
  select(Species = SpeciesName, OrigValueStr, OrigUnitStr) %>% 
  mutate(SLA = suppressWarnings(as.numeric(OrigValueStr)),
         Source = "TRY") %>% 
  filter(!is.na(SLA)) ->
  trydata

# Test for distribution differences
ks_results <- list()
for(sp in unique(sla$Species)) {
  x <- filter(sla, Species == sp)$specific_leaf_area
  y <- filter(trydata, Species == sp)$SLA
  if(length(x) > 5 && length(y) > 5) {
    ks <- ks.test(x, y, alternative = "two.sided", exact = NULL)
    ks_results[[sp]] <- tibble(N = length(x), N_try = length(y),
                               D = ks$statistic, p.value = ks$p.value)
  }
}
bind_rows(ks_results, .id = "Species") %>% 
  kable(digits = 3, format = "html") %>% 
  kable_styling(bootstrap_options = bo)

sla %>% 
  select(Species_common, Species, SLA = specific_leaf_area) %>% 
  mutate(Source = "This study") %>% 
  bind_rows(trydata) %>% 
  filter(SLA < 600) ->
  combined_data

fig_try <- ggplot(combined_data, aes(x = SLA, fill = Source)) + 
  geom_density(alpha = 0.5) + 
  facet_wrap(~Species) +
  xlab(expression(SLA~(cm^2~g^-1)))
print(fig_try)
ggsave("figures/figure_try.png")
```

## Statistics: species differences

```{r stats-species}
# Does SLA differ between species? An overall test
m_species <- lm(specific_leaf_area ~ Species_code, data = sla)
print(summary(m_species))
TukeyHSD(aov(m_species))
```

## Statistics: elevation differences

```{r stats-elevation}
# Does SLA between shoreline and upland AFTER accounting for species?
m_elevation <- lm(specific_leaf_area ~ Species * Elevation, data = sla)
print(car::Anova(m_elevation))
```

## Statistics: position differences

```{r stats-position}
# Does SLA vary between high and low canopy position?
# Here we can use a PAIRED t-test because samples taken from same trees
sla %>% 
  # Some trees were sampled more than once. Just look at earlier samples for simplicity
  filter(mdy(Date) < mdy("8/1/2019")) %>% 
  select(Plot, Species_common, DBH, Tag, Position, specific_leaf_area) %>% 
  spread(Position, specific_leaf_area) -> 
  sla_position

tt_position <- t.test(sla_position$`High/Sun`, sla_position$`Low/Shade`, paired = TRUE)
print(tt_position)
```

## Statistics: salinity differences

```{r stats-salinity}
# Does salinity affect SLA?
m_salinity <- lm(specific_leaf_area ~ Species * Salinity, data = sla)
print(car::Anova(m_salinity))
```

## Litter data

```{r neon-data}
# NEON litter data downloaded 2021-03-20 for comparison
neon_pertrap <- read_csv("NEON_litterfall/stackedFiles/ltr_pertrap.csv",
                         col_types = "cccccdcdddcccddDccccdccTc")
neon_massdata <- read_csv("NEON_litterfall/stackedFiles/ltr_massdata.csv",
                          col_types = "ccccccTTTcTTcccccdcccTc")
neon_fielddata <- read_csv("NEON_litterfall/stackedFiles/ltr_fielddata.csv",
                           col_types = "ccccccDDcdcccccccTc")

neon_fielddata %>% 
  # isolate records with trap problems recorded
  filter(!grepl("OK", trapCondition, fixed = TRUE)) %>% 
  select(collectDate, trapID) %>% 
  mutate(Year = year(collectDate)) ->
  trap_problems

neon_massdata %>% 
  select(trapID, collectDate, functionalGroup, dryMass) %>% 
  filter(functionalGroup == "Leaves") %>% 
  mutate(Year = year(collectDate)) %>% 
  # compute annual sums
  group_by(Year, trapID) %>% 
  summarise(dryMass = sum(dryMass), .groups = "drop") %>% 
  # remove traps with problems in a given year
  anti_join(trap_problems, by = c("Year", "trapID")) %>% 
  # pull in trap size information
  left_join(select(neon_pertrap, trapID, trapType, trapSize), by = "trapID") %>% 
  filter(trapType == "Elevated") %>% 
  mutate(dryMass_m2 = dryMass / trapSize) ->
  neon_litter
```

```{r litter-data}
# Read in litter data
list.files("../SLA/litter/", pattern = "*.csv", full.names = TRUE) %>% 
  lapply(read_csv, col_types = "ccccddddddc") %>%
  bind_rows ->
  litter_data_raw

# This is our mapping from Species (in the litter data) to species code (as in SLA data)
species_litter_map <- c("M_leaf_beech" = "FAGR",
                        "M_leaf_oak" = "QUAL",
                        "M_leaf_tulip" = "LITU",
                        "M_leaf_other" = "OTHER")  # temporary

litter_data_raw %>% 
  # filter for exactly one year of litter data
  mutate(Date_collected = mdy(Date_collected)) %>% 
  filter(Date_collected >= mdy("10/1/2018") & Date_collected < mdy("10/1/2019")) %>% 
  select(Plot, Trap, Date_collected, starts_with("M_leaf")) %>% 
  # restructure data, using only leaf litter
  gather(Species, Value, starts_with("M_leaf")) %>% 
  # Traps are 0.5 m2; convert to 1 m2
  mutate(Value = Value / 0.5) ->
  litter_2019

litter_2019 %>% 
  # Compute sum of leaf biomass for each trap and species 
  group_by(Plot, Species, Trap) %>% 
  summarise(annual_litter_mass = sum(Value, na.rm = TRUE), .groups = "drop") %>%
  # Add species codes
  mutate(Species_code = species_litter_map[Species]) ->
  avg_litter

# bar graph 
neon_md <- median(neon_litter$dryMass_m2)
neon_sd <- sd(neon_litter$dryMass_m2)
avg_litter_plot <- ggplot(avg_litter, aes(Trap, annual_litter_mass, fill = Species_code)) +
  geom_col() +
  facet_wrap(~Plot) +
  ylab(expression(Leaf~litterfall~(g~m^-2))) +
  annotate(geom = "rect", xmin = -Inf, xmax = Inf,
           ymin = neon_md - neon_sd, ymax = neon_md + neon_sd, alpha = 0.3) +
  geom_hline(yintercept = neon_md, linetype = 2, alpha = 0.75) +
  geom_hline(yintercept = neon_md - neon_sd, linetype = 2, alpha = 0.3) +
  geom_hline(yintercept = neon_md + neon_sd, linetype = 2, alpha = 0.3)

print(avg_litter_plot)

litter_2019 %>% 
  # add all species together for each day of collection and plot and trap
  group_by(Date_collected, Plot, Trap) %>% 
  summarise(Value = sum(Value),
            yearday = yday(unique(Date_collected)),
            .groups = "drop") %>% 
  # compute cumulative litter mass for the year for each plot and trap
  arrange(yearday) %>% 
  group_by(Plot, Trap) %>% 
  mutate(cum_litter = cumsum(Value)) %>%
  # compute the mean and s.d. across all traps within a plot, for each day
  group_by(Plot, Date_collected) %>% 
  summarise(mean_litter = mean(cum_litter), 
            sd_mean_litter = sd(cum_litter),
            .groups = "drop") ->
  annual_litter

# Line graph
avg_litter_plot <- ggplot(annual_litter, 
                          aes(yday(Date_collected), mean_litter, color = Plot)) +
  geom_line(na.rm = TRUE) +
  labs(x = "Day of year", 
       y = expression(Leaf~litterfall~(g~m^-2))) +
  annotate(geom = "rect", xmin = -Inf, xmax = Inf,
           ymin = neon_md - neon_sd, ymax = neon_md + neon_sd, alpha = 0.3) +
  geom_hline(yintercept = neon_md, linetype = 2, alpha = 0.75) +
  geom_hline(yintercept = neon_md - neon_sd, linetype = 2, alpha = 0.3) +
  geom_hline(yintercept = neon_md + neon_sd, linetype = 2, alpha = 0.3)
print(avg_litter_plot)
```

## Leaf area index

```{r lai}

# join with SLA data 

sla_for_lai <- sla %>% 
  group_by(Plot, Species_code) %>% 
  summarise(avg_sla = mean(specific_leaf_area))

# At this point, we have SLA by species, but the litter data is not as resolved; there's an
# "Other" category we need to have an SLA for. To do this, compute a weighted mean SLA based
# on the occurrence (squared diameter) of secondary species not broken out in the litter data:
# sweetgum, black gum, red maple, ...?
inventory %>% 
  filter(Species_code %in% c("ACRU", "NYSY", "LIST")) %>% 
  group_by(Plot, Species_code) %>% 
  summarise(weight = sum(DBH ^ 2)) ->
  plot_weights

sla_for_lai <- sla_for_lai %>% 
  left_join(plot_weights, by = c("Plot", "Species_code")) %>% 
  filter(!is.na(weight)) %>% 
  group_by(Plot) %>% 
  summarise(Species_code = "OTHER",
            avg_sla = weighted.mean(avg_sla, w = weight)) %>% 
  # Now bind the SLA means with our new SLA_other data
  bind_rows(sla_for_lai) 

# We have litter data, but no SLA samples, from HSHE/HSME/HSLE
# For these we will use control and/or shore
# Make a table that tells us what plot's SLA to use for each plot
sla_map <- tibble(Plot = unique(avg_litter$Plot),
                  Use_SLA_from_plot = Plot)
sla_map$Use_SLA_from_plot[sla_map$Plot %in% c("HSHE", "HSME")] <- "Control"
sla_map$Use_SLA_from_plot[sla_map$Plot == "HSLE"] <- "Shore"

avg_litter %>% 
  left_join(sla_map, by = "Plot") %>% 
  left_join(sla_for_lai, by = c("Use_SLA_from_plot" = "Plot", "Species_code")) ->
  sla_litter_joined

if(nrow(avg_litter) != nrow(sla_litter_joined)) {
  stop("These joins should not have added any rows, but they did!")
}

lai <- sla_litter_joined %>% 
  # cm2/g * g/m2 = LAI; convert to m2/g for reporting 
  mutate(LAI = avg_sla * annual_litter_mass / (100 * 100)) %>% 
  group_by(Plot, Trap) %>% 
  # In 467, we are removing NAs from lack of certain species in some plots, in the future we want to
  # use the average values to fill these in
  # Maybe we do this above, in 454-457, just by using overall mean values instead of a map
  summarise(lai_trap = round(sum(LAI, na.rm = TRUE), 2)) %>% 
  summarise(lai_plot = round(mean(lai_trap), 2), 
            lai_plot_sd = round(sd(lai_trap), 2)) %>% 
  arrange(Plot) %>% 
  print()
```


``` {r lai-figure}

sla_litter_joined %>% 
  # cm2/g * g/m2 = LAI; convert to m2/g for reporting 
  mutate(LAI = avg_sla * annual_litter_mass / (100 * 100)) %>% 
  # Compute mean plot LAI by plot and species across traps
  group_by(Plot, Species_code) %>% 
  summarise(value = round(mean(LAI, na.rm = TRUE), 2)) ->
  lai_plot_data

lai_plot <- ggplot(lai_plot_data, aes(Plot, value, fill = Species_code)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90), 
        legend.title = element_text(size = 11), 
        legend.text = element_text(size = 9),
        plot.title = element_text(size = 11)) +
  labs(title = "LAI at Sampling Plots", x = "Plot", y = "LAI")
print(lai_plot)

# inset plot
litter_lai_plot  <-
  ggdraw() +
  draw_plot(avg_litter_plot) +
  draw_plot(lai_plot, x = 0.1, y = .45, width = .5, height = .5)
print(litter_lai_plot)

```


The End.

```{r sessionInfo}
sessionInfo()
```
